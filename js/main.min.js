var app={};app.scrollReady=!1,app.deactivateButton=!1,app.ismobile=!1,app.boxes=document.querySelectorAll(".box"),app.people=document.querySelectorAll(".person"),app.contactOpen=!1,$(function(){app.init()}),app.init=function(){console.log("its working"),app.responsive(),app.bioClick(),app.handwritting(),app.fullMenu(),app.contactGo(),app.reelGo(),app.contactAnimation(),app.resizeWindow(),app.folderControl(),app.openVideoModal()},app.responsive=function(){function e(){$("header#teaser #logo button").addClass("pop-out"),window.setTimeout(app.action(),3e3),window.setTimeout(app.bounce,2250)}var t=$(window).width();t<1101?(window.setTimeout(e,1500),app.ismobile=!0):console.log("it is not a mobile device")},app.bioClick=function(){app.ismobile&&$(".person").on("click",function(){var e=$(this);e.find("#bioText").toggleClass("displayBio")})},app.action=function(){$("section#subheader").addClass("activateSubheader"),$("section#logo button").addClass("out");var e=$("path:not(defs path)");e.each(function(e,t){t.style.strokeDasharray=t.style.strokeDashoffset=t.getTotalLength()});var t=($(".arrow"),new TimelineMax);t.add([TweenLite.to(e.eq(0),.5,{strokeDashoffset:0,delay:.2}),TweenLite.to(e.eq(1),.5,{strokeDashoffset:0,delay:.5}),TweenLite.to(e.eq(2),.5,{strokeDashoffset:0,delay:1}),TweenLite.to(e.eq(3),.5,{strokeDashoffset:0,delay:1.1}),TweenLite.to(e.eq(4),.5,{strokeDashoffset:0,delay:1.4}),TweenLite.to(e.eq(5),.5,{strokeDashoffset:0,delay:1.7}),TweenLite.to(e.eq(6),.5,{strokeDashoffset:0,delay:1.8}),TweenLite.to(e.eq(7),.5,{strokeDashoffset:0,delay:1.8}),TweenLite.to(e.eq(8),.5,{strokeDashoffset:0,delay:1.8}),TweenLite.to(e.eq(9),.5,{strokeDashoffset:0,delay:1.8})])},app.handwritting=function(){app.ismobile?console.log("is the mobile"):$("button#activateSubheader").on("click",function(){app.action(),app.scrollReady=!0,app.deactivateButton||window.setTimeout(app.bounce,2250)})},app.fullMenu=function(){$("button#activateFullMenu").on("click",function(){$("header").addClass("inCorner")})},app.bounce=function(){console.log("bounce"),$(".arrow").addClass("display"),$("main").css("display","flex"),$("footer").addClass("up");var e=$(".bounce"),t=1,o=new TimelineMax({repeat:-1,repeatDelay:1});o.to(e,0,{y:0,ease:Bounce.easeIn},"bounceup").to(e,t/2,{y:8,ease:Bounce.easeOut},"bounceme"),app.scroll(),o.pause},app.scroll=function(){app.scrollReady===!0&&($(window).scroll(function(e){$("html, body").animate({scrollTop:0},2e3),$("html, body").addClass("doNotMove"),$("button#activateSubheader").addClass("shrink"),$("header#teaser #subheader").addClass("shrink"),$("header#teaser #logo").addClass("shrink"),$("header#teaser").addClass("shrink"),app.deactivateButton=!0,$(".arrow").removeClass("display").removeClass("bounce"),window.setTimeout(app.svgsArrive,200)}),$(".arrow").on("click",function(e){$("html, body").animate({scrollTop:0},2e3),$("html, body").addClass("doNotMove"),$("button#activateSubheader").addClass("shrink"),$("header#teaser #subheader").addClass("shrink"),$("header#teaser #logo").addClass("shrink"),$("header#teaser").addClass("shrink"),app.deactivateButton=!0,$(".arrow").removeClass("display").removeClass("bounce"),window.setTimeout(app.svgsArrive,200)}))},app.svgsArrive=function(){$("div#phone-div").addClass("arrive"),$("div#video-div").addClass("arrive")},app.contactGo=function(){$("svg #cell").on("click",function(){$("div#phone-div").addClass("flyAway"),$("div#video-div").addClass("flyAway"),$("header#teaser.shrink").addClass("flyAway"),$("section#contactInfo").addClass("contactArrive"),app.contactOpen=!0}),$("div.closeContact").on("click",function(){$("div#phone-div").removeClass("flyAway"),$("div#video-div").removeClass("flyAway"),$("header#teaser.shrink").removeClass("flyAway"),$("section#contactInfo").removeClass("contactArrive"),app.contactOpen=!1})},app.reelGo=function(){function e(){app.contactOpen||($("div#phone-div").removeClass("arrive"),$("div#video-div").removeClass("arrive"),$("section#videoPlayer").addClass("playerArrive"),t&&(app.boxes.forEach(function(e){app.makeBoxIntoCanvas(e)}),t=!1),n.play())}var t=!0,o=document.getElementById("reelControl"),a=o.querySelector("iframe"),n=new Vimeo.Player(a);$("svg #cassette").on("click",function(){e()}),$("text#We-make-videos-good").on("click",function(){e()}),$("div.closePlayer").on("click",function(){vimeoWrap=$("#vimeoWrap"),vimeoWrap.html(vimeoWrap.html()),$("div#phone-div").addClass("arrive"),$("div#video-div").addClass("arrive"),$("section#videoPlayer").removeClass("playerArrive"),n.pause()})},app.contactAnimation=function(){function e(){var e=$("path.shine.middle.left"),t=$("path.shine.top.left"),o=$("path.shine.bottom.left"),a=$("path.shine.top.right"),n=$("path.shine.middle.right"),i=$("path.shine.bottom.right"),s=[{x:0,y:0},{x:-3,y:.5},{x:-5,y:1}],r=[{x:0,y:0},{x:-5,y:.5},{x:-7,y:1}],l=[{x:0,y:0},{x:-.5,y:-1},{x:1,y:-3}],d=[{x:0,y:0},{x:.5,y:.5},{x:2,y:0}],c=[{x:0,y:0},{x:.5,y:5},{x:-2,y:9}],p=[{x:0,y:0},{x:.5,y:3},{x:-1,y:5}],u=[{x:0,y:0},{x:.5,y:-1},{x:1,y:-2}],v=[{x:0,y:0},{x:-.5,y:.5},{x:-1,y:1}];tl2=new TimelineMax({repeat:-1,yoyo:!0}),tl2.add([TweenLite.to(e,1,{bezier:{curviness:.7,values:s},ease:Bounce.easeOut,delay:0}),TweenLite.to(t,1,{bezier:{curviness:1,values:r},ease:Power1.easeOut,delay:.4}),TweenLite.to(o,1,{bezier:{curviness:1.5,values:l},ease:Bounce.easeOut,delay:0}),TweenLite.to(o,1,{bezier:{curviness:.5,values:d},ease:Power1.easeInOut,delay:1})]),tl3=new TimelineMax({repeat:-1,yoyo:!0}),tl3.add([TweenLite.to(i,1,{bezier:{curviness:1,values:v},ease:Power0.easeInOut,delay:0}),TweenLite.to(a,1.5,{bezier:{curviness:.7,values:c},rotation:20,ease:Expo.easeInOut,delay:.5}),TweenLite.to(n,1,{bezier:{curviness:1,values:p},rotation:10,ease:Power1.easeOut,delay:0}),TweenLite.to(n,1.5,{bezier:{curviness:1,values:u},ease:Power1.easeOut,delay:1})])}$("svg #cell").on("mouseover",function(){$("path#text-contact").toggle(),$("path#text-hello").toggle()}),$("svg #cassette").on("mouseover",function(){e()}),$("text#We-make-videos-good").on("mouseover",function(){e()}),$("text#We-make-videos-good").on("mouseout",function(){tl2.pause(),tl3.pause()}),$("svg #cassette").on("mouseout",function(){tl2.pause(),tl3.pause()})},app.resizeWindow=function(){function e(){window.location.reload(!0)}var t=$(window).width();$(window).resize(function(){var o=$(window).width();console.log(t,o),t>=1100&&o<=1100&&e(),t<=1100&&o>=1100&&e(),t=o})},app.folderControl=function(){var e=!0;$("div.folder").on("click",function(){$("div.folder").removeClass("activeFolder"),$(this).addClass("activeFolder"),$(this).hasClass("who")&&e&&(app.people.forEach(function(e){app.makeBioIntoCanvas(e)}),e=!1)})},app.makeBoxIntoCanvas=function(e){function t(){e.addEventListener("mousemove",o),window.addEventListener("resize",a),e.appendChild(d),a(),n()}function o(e){m.push({time:Date.now(),x:e.clientX,y:e.clientY})}function a(){d.width=u.width=e.clientWidth,d.height=u.height=e.clientHeight}function n(){m=m.filter(function(e){var t=Date.now()-e.time;return t<f}),i(),r(),requestAnimationFrame(n)}function i(){var e=20,t=40,o=t-e,a=50;h.clearRect(0,0,u.width,u.height),h.lineCap="round",h.shadowBlur=2,h.shadowColor="#000";for(var n=1;n<m.length;n++){var i=m[n],r=m[n-1],c=s(i,r),p=Math.max(0,Math.min(a,c)),v=(a-p)/a;h.lineWidth=e+v*o;var y=l.scrollTop,w=Date.now()-i.time,g=(f-w)/f;h.strokeStyle="rgba(0, 0, 0, "+g+")",h.beginPath(),h.moveTo(r.x-d.offsetLeft,r.y-d.offsetTop+y),h.lineTo(i.x-d.offsetLeft,i.y-d.offsetTop+y),h.stroke()}}function s(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function r(){var t=e.children[0].innerHTML.toUpperCase(),o=e.children[1].innerText,a=d.width,n=d.height;p.clearRect(0,0,a,n),p.globalCompositeOperation="source-over",p.font="32px Langdon",p.textBaseline="top",p.fillStyle="#91868A",p.fillRect(0,0,a,n),p.textAlign="center",p.fillStyle="#FFF",p.fillText(t,d.width/2,50),p.font="22px Mark My Words",p.strokeStyle="#0072BC",p.lineWidth=2,p.beginPath(),p.moveTo(d.width/2-100,83),p.lineTo(d.width/2+100,83),p.stroke(),p.fillText("director",d.width/2,125),p.font="25px Open Sans",p.fillStyle="#E48723",p.fillText(o,d.width/2,140),p.globalCompositeOperation="destination-in",p.drawImage(u,0,0)}var l=document.getElementById("videoControl"),d=document.createElement("canvas"),c="imageCanvas"+e.id;d.setAttribute("id",c);var p=d.getContext("2d"),u=document.createElement("canvas"),v="lineCanvas"+e.id;u.setAttribute("id",v);var h=u.getContext("2d"),f=6e3,m=[];t()},app.makeBioIntoCanvas=function(e){function t(){e.addEventListener("mousemove",o),window.addEventListener("resize",a),e.appendChild(l),a(),n()}function o(e){f.push({time:Date.now(),x:e.clientX,y:e.clientY})}function a(){y=$("#imageCanvas"+e.id).offset(),l.width=p.width=e.clientWidth,l.height=p.height=e.clientHeight}function n(){f=f.filter(function(e){var t=Date.now()-e.time;return t<h}),i(),r(),requestAnimationFrame(n)}function i(){var e=60,t=150,o=t-e,a=50;v.clearRect(0,0,p.width,p.height),v.lineCap="round",v.shadowBlur=30,v.shadowColor="#000";for(var n=1;n<f.length;n++){var i=f[n],r=f[n-1],l=s(i,r),d=Math.max(0,Math.min(a,l)),c=(a-d)/a;v.lineWidth=e+c*o;var u=Date.now()-i.time,m=(h-u)/h;v.strokeStyle="rgba(0, 0, 0, "+m+")",v.beginPath(),v.moveTo(r.x-y.left,r.y-y.top),v.lineTo(i.x-y.left,i.y-y.top),v.stroke()}}function s(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function r(){function e(e,t,o,a,n,i){for(var s=t.split("\n"),r=0;r<s.length;r++){for(var l="",d=s[r].split(" "),c=0;c<d.length;c++){var p=l+d[c]+" ",u=e.measureText(p),v=u.width;v>n?(e.fillText(l,o,a),l=d[c]+" ",a+=i):l=p}e.fillText(l,o,a),a+=i}}var t=l.width,o=l.height;c.clearRect(0,0,l.width,l.height),c.globalCompositeOperation="source-over",c.font="300 22px Open Sans",c.textBaseline="top",c.fillStyle="black",c.fillRect(0,0,t,o),c.fillStyle="#FFF",e(c,m,15,15,275,30),c.globalCompositeOperation="destination-in",c.drawImage(p,0,0)}var l=document.createElement("canvas"),d="imageCanvas"+e.id;l.setAttribute("id",d);var c=l.getContext("2d"),p=document.createElement("canvas"),u="lineCanvas"+e.id;p.setAttribute("id",u);var v=p.getContext("2d"),h=2500,f=[],m=document.getElementById("bioText").innerText,y={};t()},app.openVideoModal=function(){function e(e){if("CANVAS"===e.target.tagName){var t=e.target.parentElement,o=t.querySelector("iframe"),a=new Vimeo.Player(o);t.classList.add("showModal");var n=document.querySelectorAll("iframe");n.forEach(function(e){var t=new Vimeo.Player(e);t.pause()}),a.play(),document.getElementById("mainFooter").classList.remove("up")}}function t(e){var t=document.getElementById(e),o=t.querySelector("iframe"),a=new Vimeo.Player(o);a.pause(),t.classList.remove("showModal"),document.getElementById("mainFooter").classList.add("up")}var o=document.querySelectorAll(".box");o.forEach(function(o){var a=o.id;o.addEventListener("click",e);var n=o.querySelector(".closeModal");n.addEventListener("click",function(){t(a)})})};